function duplicateSheetAndRename() {
  var nazwaArkuszaDoKopiowania = "Test 1"

  var aktywnyArkusz = SpreadsheetApp.getActiveSpreadsheet();

  var arkuszDoKopiowania = aktywnyArkusz.getSheetByName(nazwaArkuszaDoKopiowania);

  if (!arkuszDoKopiowania) {
    Logger.log("Arkusz do skopiowania o nazwie " + nazwaArkuszaDoKopiowania + " nie istnieje.");
    return;
  }

  var nowyArkusz = arkuszDoKopiowania.copyTo(aktywnyArkusz);

  var teraz = new Date();
  var godzina = teraz.getHours();
  var minuta = teraz.getMinutes();
  var sekunda = teraz.getSeconds();
  
  var nowaNazwa = "Tab_" + godzina + "-" + minuta + "-" + sekunda;
  
  Rename(nowyArkusz, nowaNazwa);
}

function Rename(tab, name){
  var sheetNames = tab.getParent().getSheets().map(sheet => sheet.getName());

  function checkName(){
    if(sheetNames.includes(name)){
      name = name + '*';
      return checkName();
    }
    tab.setName(name);
  }
  
  checkName(name);
}
